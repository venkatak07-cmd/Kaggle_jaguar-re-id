Jaguar Re-Identification with Deep Metric Learning

This repository implements an end-to-end Jaguar Re-Identification (ReID) system using deep metric learning, ConvNeXt, and ArcFace loss.
The pipeline is designed for high-accuracy wildlife re-identification, enabling robust matching between query and gallery images under varying poses, lighting, and backgrounds.

ğŸš€ Key Features

âœ… ConvNeXt backbone (ImageNet pretrained via timm)

âœ… ArcFace loss for discriminative embedding learning

âœ… GeM pooling for stronger spatial feature aggregation

âœ… Test-Time Augmentation (TTA) with horizontal flips

âœ… Cosine similarityâ€“based retrieval

âœ… Interactive & static visualizations (PCA, t-SNE, heatmaps)

âœ… Submission-ready Kaggle pipeline

ğŸ§  Model Architecture
Input Image (224Ã—224)
        â†“
ConvNeXt-Small Backbone
        â†“
GeM Pooling
        â†“
BatchNorm Embedding Head
        â†“
ArcFace Margin Classifier (Training Only)
        â†“
L2-Normalized Embeddings (Inference)

ğŸ“‚ Project Structure
â”œâ”€â”€ train.csv
â”œâ”€â”€ test.csv
â”œâ”€â”€ train/
â”‚   â””â”€â”€ train/          # Training images
â”œâ”€â”€ test/
â”‚   â””â”€â”€ test/           # Test images
â”œâ”€â”€ jaguar_best_model.pth
â”œâ”€â”€ submission.csv
â”œâ”€â”€ train.py / notebook.ipynb
â””â”€â”€ README.md

âš™ï¸ Configuration Highlights
Parameter	Value
Backbone	convnext_small.fb_in1k
Image Size	224 Ã— 224
Embedding Dim	768
Loss	ArcFace
Optimizer	AdamW
Scheduler	CosineAnnealingLR
Batch Size	32
Epochs	8
Mixed Precision	âœ…
ğŸ§ª Training Strategy

Strong data augmentation

Random affine

Color jitter

Horizontal flip

Random erasing

Metric learning objective

ArcFace margin (m=0.5, s=30)

Mixed-precision training

Faster convergence

Lower GPU memory usage

ğŸ” Inference & Similarity Scoring

Extract embeddings for query + gallery images

Apply TTA averaging

L2-normalize embeddings

Compute cosine similarity matrix

Generate submission with similarity scores clipped to [0, 1]

ğŸ“Š Visualizations Included
Static

ğŸ“ˆ Training loss curve

ğŸ“‰ Similarity score distribution

ğŸ§­ PCA & t-SNE embedding projections

ğŸ”¥ Cosine similarity & distance heatmaps

ğŸ–¼ï¸ Top similar image pairs

Interactive (Plotly)

ğŸ§  Interactive PCA / t-SNE scatter plots

ğŸ§© Hover-enabled similarity heatmaps

ğŸ–±ï¸ Image-level exploration

ğŸ› ï¸ Tech Stack

Languages

Python

Deep Learning

PyTorch

TIMM

Torch AMP (mixed precision)

Data & Visualization

NumPy, Pandas

Matplotlib, Seaborn

Plotly

ML Utilities

scikit-learn

PIL, torchvision

ğŸ“ˆ Results & Observations

ArcFace significantly improves inter-class separation

GeM pooling outperforms standard average pooling

TTA improves retrieval stability

Embeddings show clear clustering in PCA/t-SNE space

ğŸ How to Run
pip install timm torch torchvision plotly seaborn scikit-learn
python train.py


Or run directly in Kaggle Notebook (GPU recommended).

ğŸ“Œ Future Improvements

ğŸ”„ k-reciprocal re-ranking

ğŸ§¬ Hard sample mining

ğŸ§  Larger backbones (ConvNeXt-B, ViT)

ğŸ“ Cross-validation with fold ensembling
